# Building-an-Android-Pentest-Lab

**Table of Contents**
1) Introduction
2) Emulators
3) Installing Docker
4) Installing MobSF Docker Image on Linux
5) ADB



**What is Android?**

Android is a versatile and widely used operating system designed for mobile devices like smartphones, tablets, and smartwatches. Developed by a consortium of technology companies, Android offers a user-friendly interface and provides extensive customization options. It supports a vast ecosystem of applications, available through various app stores, enabling users to personalize their devices according to their preferences and needs. With its open-source nature, Android encourages developers to create and innovate, leading to a diverse range of software choices for users. Whether it's for communication, productivity, entertainment, or staying connected, Android offers a flexible and robust platform that powers a multitude of devices worldwide.

**Emulators**

Android emulators serve as valuable tools for pentesters, enabling them to create virtual environments to assess and analyze Android applications for potential security weaknesses. Several Android emulators, such as Android-x86, Anbox, and AndroVM, have been purposefully developed for pentesting purposes. These emulators are highly regarded and extensively employed by developers, testers, and users within the industry. Let's delve into each of them to gain a better understanding of their capabilities.

1. Android-x86: Android-x86 is an open-source project that aims to port the Android operating system to run on traditional x86-based hardware, such as desktop computers and laptops. It provides a full-fledged Android experience on non-mobile devices, allowing users to enjoy the benefits of Android apps and ecosystem on a larger screen. Android-x86 is known for its compatibility with a wide range of hardware, providing users with the flexibility to install it on various devices. It is actively maintained and frequently updated to ensure optimal performance and compatibility with the latest Android versions. Whether for development, testing, or simply exploring Android on different hardware, Android-x86 offers an excellent solution for running Android natively on x86-based systems.

2. Anbox: Anbox, short for "Android in a Box," is an open-source project that enables running Android applications directly on Linux-based operating systems. It provides a seamless integration of Android apps into the Linux environment, allowing users to enjoy their favorite Android apps without the need for an actual Android device. Anbox utilizes containerization technology to create a secure and isolated environment for running Android apps, ensuring compatibility and performance. It offers a lightweight solution that can be easily installed and configured on Linux distributions. With Anbox, users can leverage the vast Android app ecosystem and benefit from the convenience of accessing their favorite apps on their Linux systems.

3. AndroVM: AndroVM is a specialized Android virtual machine that allows users to run Android operating systems on their computers. It provides a complete virtualized Android environment, enabling users to test apps, conduct development, or explore the Android ecosystem without the need for physical devices. AndroVM offers a range of features such as easy installation, customizable settings, and integration with the host operating system. It is designed to provide a smooth and responsive Android experience within a virtualized environment, making it a popular choice among developers and enthusiasts. With AndroVM, users can experiment with different Android versions, test apps on various screen sizes, and simulate different device configurations, all from their desktop or laptop computers.

**Installing Docker on a Debian Based Machine**

A Debian-based machine is a computer system or operating system derived from Debian Linux. Debian is known for stability, security, and its package management system. It includes components like the Debian package manager (APT) and system configuration tools. Debian-based machines offer a consistent Linux environment with access to a vast software repository. Popular examples include Ubuntu and Linux Mint. They provide reliability and flexibility for desktop, server, and specialized use cases, making them popular among Linux enthusiasts and administrators.

1) ```sudo apt update```
2) ```sudo apt intall -y docker.io```
3) ```sudo systemctl enable docker --now```
4) ```docker```



**Installing MobSF Docker Image on Linux**

The MobSF Docker image is a ready-to-use containerized version of MobSF (Mobile Security Framework). It offers a convenient and isolated environment for comprehensive mobile app security testing. With pre-installed dependencies and configurations, users can quickly launch MobSF instances and leverage its features, including static and dynamic analysis, vulnerability scanning, and binary analysis. The Docker image simplifies setup, ensuring consistent and reproducible results for identifying vulnerabilities and improving app security.

1) Using Docker, download the MobSF Docker image using the following command:

```sudo docker pull opensecurity/mobile-security-framework-mobsf```


2) Once ModSF is installed, run it using the following command:

```sudo docker run -it -p 8000:8000 opensecurity/mobile-security-framework-mobsf```

![Screenshot from 2023-07-03 13-22-07](https://github.com/ByteNinjaa/Builidng-an-Android-Pentest-Lab/assets/45305495/68efce34-8d78-4cc5-8f86-d4b8b7abd207)



3) Open a new terminal and list all the containers using this command:

```sudo docker ps -a```

![Screenshot from 2023-07-03 13-24-30](https://github.com/ByteNinjaa/Builidng-an-Android-Pentest-Lab/assets/45305495/2d88ecaa-3f27-4d75-b811-9b2bb877e1c2)


4) Start the container using this command:

```sudo docker start <container id>```

![Screenshot from 2023-07-03 13-25-54](https://github.com/ByteNinjaa/Builidng-an-Android-Pentest-Lab/assets/45305495/da785bf3-ec4d-493d-ae18-42ef02b525a0)


5) Once the docker image is running, navigate to "0.0.0.0:8000". This is where you can access MobSF.

![Screenshot from 2023-07-03 13-26-57](https://github.com/ByteNinjaa/Builidng-an-Android-Pentest-Lab/assets/45305495/548c74c3-75b2-40c3-b2e6-bb55d2afa0a7)


6) When you are done using MobSF, you can use the following command to stop it:

```sudo docker stop <container id>```



**ADB**
ADB, which stands for Android Debug Bridge, is a versatile command-line tool that provides a bridge of communication between your computer and Android devices. It allows you to interact with your Android device or emulator directly from your computer, enabling a wide range of debugging, troubleshooting, and device management tasks.

With ADB, you can perform various operations such as installing and uninstalling apps, transferring files, accessing system logs, capturing screenshots, recording screen activity, and even running shell commands on your Android device. It also facilitates testing and development processes by enabling the transfer of data between your computer and the device.

Whether you're a developer working on Android apps or an Android enthusiast seeking greater control over your device, ADB is an indispensable tool that empowers you to explore and customize your Android experience. Its flexibility and extensive functionality make it a valuable asset for debugging, tweaking, and managing your Android devices efficiently and effectively.


**What is ADB on a technical level?**
On a technical level, ADB (Android Debug Bridge) works by establishing a connection between a computer and an Android device using the Android Debug Bridge daemon (adbd) running on the device. Here's a breakdown of how ADB operates:
1) Communication Protocol: ADB utilizes a client-server architecture. The computer acts as the client, and the Android device acts as the server. ADB uses a custom protocol to facilitate communication between the client and server.

2) USB Connection: The most common way to connect an Android device to a computer is via USB. When you connect your Android device to the computer with a USB cable and enable USB debugging on the device, ADB initiates a connection.

3) ADB Server: The ADB server component runs on the computer and listens for incoming connections from ADB clients. It acts as a middleman, managing communication between the client and the device.

4) ADB Client: The ADB client is the command-line tool or software running on the computer that sends commands to the ADB server. It allows you to interact with the Android device through various commands.

5) Device Identification: When the ADB server detects a connected Android device, it assigns a unique identifier, known as the device serial number, to identify the device for future communication.

6) Bridge Connection: Once the ADB server and client are connected, a bridge connection is established between the computer and the Android device. This connection allows data and commands to be sent back and forth.

7) Command Execution: The ADB client sends specific commands to the ADB server, which then relays them to the Android device. These commands can include installing or uninstalling apps, transferring files, accessing logs, capturing screenshots, and more.

8) Secure Connection: To ensure secure communication, ADB uses authentication between the client and the server. When a new connection is established, a security token is exchanged to verify the authenticity of both ends.

9) Shell Access: ADB provides shell access to the Android device, allowing you to run commands directly on the device's operating system. This is useful for debugging, troubleshooting, and running low-level tasks.

Overall, ADB acts as a bridge, enabling communication and control between the computer and the Android device. It offers a powerful set of tools and commands that facilitate various tasks, making it a valuable tool for developers, testers, and Android enthusiasts.


**ADB Commands**
1) ```adb devices```: This command lists all the Android devices connected to the computer via ADB. It helps verify if the device is successfully detected and ready for communication.

2) ```adb install <path_to_apk>```: Used to install an Android application (.apk) onto the connected device. Specify the path to the APK file, and ADB will handle the installation process.

3) ```adb uninstall <package_name>```: Uninstalls the specified package from the connected device. Provide the package name (e.g., com.example.app) to remove the corresponding application.

4) ```adb shell```: Opens a shell environment on the Android device, allowing you to execute commands directly on the device's operating system.

5) ```adb pull <remote> <local>```: Copies a file or directory from the Android device to your computer. Specify the path of the file or directory on the device as <remote> and the destination path on your computer as <local>.
6) ```adb push <local> <remote>```: Transfers a file or directory from your computer to the Android device. Specify the source path on your computer as <local> and the destination path on the device as <remote>.
7) ```adb logcat```: Displays the log messages from the device, including system messages, application logs, and debugging information. Useful for troubleshooting and debugging purposes.
8) ```adb reboot```: Restarts the connected Android device. It can be helpful when changes require a device reboot or to resolve certain issues.
9) ```adb screenrecord <filename>```: Records the screen of the Android device and saves it as a video file on your computer. Specify the desired filename for the recorded video.
10) ```adb shell am start -n <package_name>/<activity_name>```: Launches a specific activity of an application on the Android device. Provide the package name and activity name to start the desired component.

These are just a few examples of common ADB commands. ADB offers a wide range of commands to interact with Android devices, debug apps, capture screenshots, simulate device inputs, and more. For further information, you can refer to the ADB documentation or use the adb help command to view the complete list of commands and their descriptions.
